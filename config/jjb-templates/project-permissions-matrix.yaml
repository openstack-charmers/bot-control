- builder:
    name: build_zaza_runner
    builders:
        - shell: |
            #!/bin/bash -ue
            . ~/oscirc
            git clone

- job:
    name: zaza_runner
    # display-name: "Mojo Test Runner"
    project-type: freestyle
    description: |
        <p><i>Dynamically Generated Job - Do not edit through the Jenkins Web UI.  You will lose your changes.</i></p>
    node: slave
    disabled: false
    concurrent: true
    properties:
      - build-discarder:
          artifact-days-to-keep: 60
          artifact-num-to-keep: 500
      - throttle:
          max-per-node: 1
          max-total: 3
          option: project
          # NOTE(beisner): One can use either strategy/option (project or category).
          #     Category (from Jenkins master global config) wins over any max
          #     throttle values set here.  Leaving in place as an example, however.
          # categories:
          #   - overclouds
          # option: category
          # matrix-builds: false
          # matrix-configs: true
    parameters:
      - string:
          name: BUNDLE_PATH
          default: "development/ceph-base-bionic-mimic"
          description: Bundle Path
      - string:
          name: BUNDLE_REPO
          default: "git://github.com/openstack-charmers/openstack-bundles.git"
          description: Git repo for Mojo OpenStack Specs
      - string:
          name: BUNDLE_BRANCH
          default: "master"
          description: Git branch for Bundle repo
      - NO_POST_DESTROY
      - DISPLAY_NAME
    wrappers:
      - timestamps
      - build-name:
          name: '#${BUILD_NUMBER} ${ENV,var="BUNDLE_REPO"} ${ENV,var="BUNDLE_PATH"}'
    builders:
      - prep_osci_repo_if_necessary
      - build_zaza_runner
    publishers:
      - archive_artifacts

- job:
    name: test_file_assertions_ceph
    disabled: false
    project-type: matrix
    description: |
        <p><i>Dynamically Generated Job - Do not edit through the Jenkins Web UI.  You will lose your changes.</i></p>
    execution-strategy:
      sequential: true
    node: task
    triggers:
        - timed: "0 H(0-8) */15 * *"  # Twice monthly
    axes:
      - axis:
         type: user-defined
         name: BUNDLE_PATH
         values:
          - "development/ceph-base-bionic-mimic"
    builders:
      - trigger-builds:
        - project:
            - "zaza_runner"
          current-parameters: true
          block: true
          predefined-parameters: |
            BUNDLE_REPO=$BUNDLE_REPO
            BUNDLE_PATH=$BUNDLE_PATH
            BUNDLE_BRANCH=$BUNDLE_BRANCH
            DISPLAY_NAME=$BUNDLE_REPO/$BUNDLE_BRANCH $BUNDLE_PATH

- job:
    name: test_file_assertions_openstack_base
    disabled: false
    project-type: matrix
    description: |
        <p><i>Dynamically Generated Job - Do not edit through the Jenkins Web UI.  You will lose your changes.</i></p>
    execution-strategy:
      sequential: true
    node: task
    triggers:
        - timed: "0 H(0-8) */15 * *"  # Twice monthly
    axes:
      - axis:
         type: user-defined
         name: BUNDLE_PATH
         values:
          - "development/openstack-base-bionic-rocky"
    builders:
      - trigger-builds:
        - project:
            - "zaza_runner"
          current-parameters: true
          block: true
          predefined-parameters: |
            BUNDLE_REPO=$BUNDLE_REPO
            BUNDLE_PATH=$BUNDLE_PATH
            BUNDLE_BRANCH=$BUNDLE_BRANCH
            DISPLAY_NAME=$BUNDLE_REPO/$BUNDLE_BRANCH $BUNDLE_PATH